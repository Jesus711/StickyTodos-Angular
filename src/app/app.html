<div class="h-screen flex flex-col gap-4 bg-black relative">
  
  <nav class="px-6 py-3 primary flex justify-between items-center gap-4">
    <button (click)="toggleSideBar()" class="flex flex-col justify-center items-center gap-0.5 cursor-pointer">
      <div class="w-5 h-1 rounded-md bg-black"></div>
      <div class="w-5 h-1 rounded-md bg-black"></div>
      <div class="w-5 h-1 rounded-md bg-black"></div>
    </button> 
    <h1 class="flex-1 text-3xl text-secondary font-bold text-black italic">StickyTodos</h1>
    <div class="flex gap-1 text-white font-semibold bg-black rounded-sm outline-3 outline-green-900 relative">
      <button (click)="setViewMode('grid')" class="rounded-md p-1 hover:cursor-pointer bg-transparent z-10">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-grid2x2-icon lucide-grid-2x2"><path d="M12 3v18"/><path d="M3 12h18"/><rect x="3" y="3" width="18" height="18" rx="2"/></svg>
      </button>
      <button (click)="setViewMode('list')" class="rounded-md p-1 hover:cursor-pointer bg-transparent z-10">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-list-icon lucide-list"><path d="M3 5h.01"/><path d="M3 12h.01"/><path d="M3 19h.01"/><path d="M8 5h13"/><path d="M8 12h13"/><path d="M8 19h13"/></svg>
      </button>
      <div class="slider" [ngClass]="view_mode === 'grid' ? 'left-0' : 'left-[calc(100%-33px)]'"></div>
    </div>
  </nav>

  @defer (when todos | async ) {
    @if( view_mode === "grid") {
      <!-- Removed. To be added later: cdkDropList cdkDropListOrientation="mixed" (cdkDropListDropped)="drop($event)" -->
      <main class="flex flex-row max-w-[86%] min-h-[200px] flex-wrap p-8 items-center mx-auto gap-8 overflow-hidden" >
        @for (note of (todos | async); track $index) {
          <app-todo (delete)="deleteSticky($event)" (update)="updateCompleteStatus($event)" [note_info]="note"></app-todo>
        }
        @empty {
          <h2 class="flex-1 self-center text-2xl font-semibold text-white">Create a new note by clicking on the bottom right!</h2>
        }
      </main>  
    }
    @else {
      <main class="flex flex-col min-h-[200px] justify-center items-center gap-8 mx-auto px-10">
        @for (note of (todos | async); track $index) {
          <app-todo-list-item (delete)="deleteSticky($event)" (update)="updateCompleteStatus($event)" [note_info]="note"></app-todo-list-item>
        }
        @empty {
          <h2 class="text-2xl font-semibold text-white">Create a new note by clicking on the bottom right!</h2>
        }
      </main>
    }
  } @loading {
    <h2 class="text-2xl font-semibold text-white">LOADING</h2>
  } @error {
    <h2 class="text-2xl font-semibold text-white">Error occurred</h2>
  }


  <button (click)="toggleNoteModal()" class="absolute bottom-5 right-5 p-2 rounded-md bg-header flex justify-center items-center hover:cursor-pointer">
    <span class="text-black flex justify-center items-center">New note</span>
    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-plus-icon lucide-plus"><path d="M5 12h14"/><path d="M12 5v14"/></svg>
  </button>

  @if (showNoteModal) {
    <div class="absolute h-screen flex w-full justify-center items-center bg-gray-900/50">
      <app-todo-form (closeModal)="toggleNoteModal()" (addTodo)="createNewSticky($event)"></app-todo-form>
    </div> 
  }
  <app-sidebar [display]="showSideBar" (closeSidebar)="toggleSideBar()"></app-sidebar>
</div>